this is copied from xkk1
